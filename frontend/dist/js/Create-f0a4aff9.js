import{_ as q}from"./_plugin-vue_export-helper-383fd9f4.js";/* empty css                *//* empty css                 *//* empty css                  *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                        */import{u as F,r as m,b as I,c,d as v,f as a,w as o,a5 as N,e as V,F as L,y as R,z as j,j as x,k as p,l as M,m as S,aj as z,n as A,p as O,E as T,h as D}from"./index-0407e335.js";import{createLabApi as G}from"./lab-ae8b6f89.js";const H={class:"laboratory-create"},J={__name:"Create",setup(K){const _=F(),b=m(),i=m(!1),d=m(!1),f=m([]),l=I({lab_name:"",location:"",capacity:1,lab_status:"可用",manager_id:null}),E={lab_name:[{required:!0,message:"请输入实验室名称",trigger:"blur"},{min:2,max:100,message:"长度在 2 到 100 个字符",trigger:"blur"}],location:[{required:!0,message:"请输入实验室位置",trigger:"blur"},{max:200,message:"长度不能超过 200 个字符",trigger:"blur"}],capacity:[{required:!0,message:"请输入容量",trigger:"blur"},{type:"number",min:1,message:"容量必须大于0",trigger:"blur"}],lab_status:[{required:!0,message:"请选择状态",trigger:"change"}]},k=async r=>{if(r){d.value=!0;try{f.value=[{user_id:1,name:"张老师"},{user_id:2,name:"李老师"},{user_id:3,name:"王老师"}]}catch{p.error("搜索用户失败")}finally{d.value=!1}}},w=async()=>{try{await b.value.validate(),i.value=!0;const r={可用:"available",维护中:"maintenance",停用:"occupied"},e={name:l.lab_name,location:l.location,capacity:l.capacity,status:r[l.lab_status],description:""},s=await G(e);(s.code===201||s.code===200||s.success)&&(p.success("实验室创建成功"),_.push("/laboratory/list"))}catch(r){r!==!1&&p.error("创建失败，请重试")}finally{i.value=!1}},h=()=>{_.back()};return(r,e)=>{const s=M,n=S,C=z,u=A,g=O,y=T,U=D,B=N;return c(),v("div",H,[a(B,null,{header:o(()=>[...e[5]||(e[5]=[V("div",{class:"card-header"},[V("span",null,"新建实验室")],-1)])]),default:o(()=>[a(U,{ref_key:"formRef",ref:b,model:l,rules:E,"label-width":"120px",class:"laboratory-form"},{default:o(()=>[a(n,{label:"实验室名称",prop:"lab_name"},{default:o(()=>[a(s,{modelValue:l.lab_name,"onUpdate:modelValue":e[0]||(e[0]=t=>l.lab_name=t),placeholder:"请输入实验室名称",maxlength:"100","show-word-limit":""},null,8,["modelValue"])]),_:1}),a(n,{label:"位置",prop:"location"},{default:o(()=>[a(s,{modelValue:l.location,"onUpdate:modelValue":e[1]||(e[1]=t=>l.location=t),placeholder:"请输入实验室位置",maxlength:"200","show-word-limit":""},null,8,["modelValue"])]),_:1}),a(n,{label:"容量",prop:"capacity"},{default:o(()=>[a(C,{modelValue:l.capacity,"onUpdate:modelValue":e[2]||(e[2]=t=>l.capacity=t),min:1,max:999,placeholder:"请输入容量"},null,8,["modelValue"])]),_:1}),a(n,{label:"状态",prop:"lab_status"},{default:o(()=>[a(g,{modelValue:l.lab_status,"onUpdate:modelValue":e[3]||(e[3]=t=>l.lab_status=t),placeholder:"请选择状态"},{default:o(()=>[a(u,{label:"可用",value:"可用"}),a(u,{label:"维护中",value:"维护中"}),a(u,{label:"停用",value:"停用"})]),_:1},8,["modelValue"])]),_:1}),a(n,{label:"负责人",prop:"manager_id"},{default:o(()=>[a(g,{modelValue:l.manager_id,"onUpdate:modelValue":e[4]||(e[4]=t=>l.manager_id=t),placeholder:"请选择负责人",filterable:"",remote:"","remote-method":k,loading:d.value},{default:o(()=>[(c(!0),v(L,null,R(f.value,t=>(c(),j(u,{key:t.user_id,label:t.name,value:t.user_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])]),_:1}),a(n,null,{default:o(()=>[a(y,{type:"primary",onClick:w,loading:i.value},{default:o(()=>[...e[6]||(e[6]=[x(" 创建 ",-1)])]),_:1},8,["loading"]),a(y,{onClick:h},{default:o(()=>[...e[7]||(e[7]=[x("取消",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])}}},te=q(J,[["__scopeId","data-v-712ad069"]]);export{te as default};
