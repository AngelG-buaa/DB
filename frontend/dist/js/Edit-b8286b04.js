import{_ as R}from"./_plugin-vue_export-helper-383fd9f4.js";/* empty css                   *//* empty css                *//* empty css                 *//* empty css                  *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                        */import{u as j,G as D,r as n,b as M,o as O,c as m,d as V,f as a,w as t,k as u,a5 as S,e as E,ai as z,z as x,F as A,y as G,j as k,l as T,m as H,aj as J,n as K,p as P,E as Q,h as W,aq as X}from"./index-0407e335.js";const Y={class:"laboratory-edit"},Z={__name:"Edit",setup($){const i=j(),h=D(),f=n(),c=n(!1),_=n(!1),p=n(!1),b=n([]),o=M({lab_id:null,lab_name:"",location:"",capacity:1,lab_status:"可用",manager_id:null}),w={lab_name:[{required:!0,message:"请输入实验室名称",trigger:"blur"},{min:2,max:100,message:"长度在 2 到 100 个字符",trigger:"blur"}],location:[{required:!0,message:"请输入实验室位置",trigger:"blur"},{max:200,message:"长度不能超过 200 个字符",trigger:"blur"}],capacity:[{required:!0,message:"请输入容量",trigger:"blur"},{type:"number",min:1,message:"容量必须大于0",trigger:"blur"}],lab_status:[{required:!0,message:"请选择状态",trigger:"change"}]},U=async()=>{const r=h.params.id;if(!r){u.error("实验室ID不存在"),i.back();return}_.value=!0;try{Object.assign(o,{lab_id:r,lab_name:"物理实验室A",location:"教学楼3楼301",capacity:30,lab_status:"可用",manager_id:1}),b.value=[{user_id:1,name:"张老师"}]}catch{u.error("加载实验室信息失败"),i.back()}finally{_.value=!1}},q=async r=>{if(r){p.value=!0;try{b.value=[{user_id:1,name:"张老师"},{user_id:2,name:"李老师"},{user_id:3,name:"王老师"}]}catch{u.error("搜索用户失败")}finally{p.value=!1}}},B=async()=>{try{await f.value.validate(),c.value=!0,u.success("实验室更新成功"),i.push("/laboratory/list")}catch(r){r!==!1&&u.error("更新失败，请重试")}finally{c.value=!1}},C=()=>{i.back()};return O(()=>{U()}),(r,e)=>{const g=T,s=H,I=J,d=K,v=P,y=Q,L=W,F=S,N=X;return m(),V("div",Y,[a(F,null,{header:t(()=>[...e[5]||(e[5]=[E("div",{class:"card-header"},[E("span",null,"编辑实验室")],-1)])]),default:t(()=>[z((m(),x(L,{ref_key:"formRef",ref:f,model:o,rules:w,"label-width":"120px",class:"laboratory-form"},{default:t(()=>[a(s,{label:"实验室名称",prop:"lab_name"},{default:t(()=>[a(g,{modelValue:o.lab_name,"onUpdate:modelValue":e[0]||(e[0]=l=>o.lab_name=l),placeholder:"请输入实验室名称",maxlength:"100","show-word-limit":""},null,8,["modelValue"])]),_:1}),a(s,{label:"位置",prop:"location"},{default:t(()=>[a(g,{modelValue:o.location,"onUpdate:modelValue":e[1]||(e[1]=l=>o.location=l),placeholder:"请输入实验室位置",maxlength:"200","show-word-limit":""},null,8,["modelValue"])]),_:1}),a(s,{label:"容量",prop:"capacity"},{default:t(()=>[a(I,{modelValue:o.capacity,"onUpdate:modelValue":e[2]||(e[2]=l=>o.capacity=l),min:1,max:999,placeholder:"请输入容量"},null,8,["modelValue"])]),_:1}),a(s,{label:"状态",prop:"lab_status"},{default:t(()=>[a(v,{modelValue:o.lab_status,"onUpdate:modelValue":e[3]||(e[3]=l=>o.lab_status=l),placeholder:"请选择状态"},{default:t(()=>[a(d,{label:"可用",value:"可用"}),a(d,{label:"维护中",value:"维护中"}),a(d,{label:"停用",value:"停用"})]),_:1},8,["modelValue"])]),_:1}),a(s,{label:"负责人",prop:"manager_id"},{default:t(()=>[a(v,{modelValue:o.manager_id,"onUpdate:modelValue":e[4]||(e[4]=l=>o.manager_id=l),placeholder:"请选择负责人",filterable:"",remote:"","remote-method":q,loading:p.value},{default:t(()=>[(m(!0),V(A,null,G(b.value,l=>(m(),x(d,{key:l.user_id,label:l.name,value:l.user_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])]),_:1}),a(s,null,{default:t(()=>[a(y,{type:"primary",onClick:B,loading:c.value},{default:t(()=>[...e[6]||(e[6]=[k(" 保存 ",-1)])]),_:1},8,["loading"]),a(y,{onClick:C},{default:t(()=>[...e[7]||(e[7]=[k("取消",-1)])]),_:1})]),_:1})]),_:1},8,["model"])),[[N,_.value]])]),_:1})])}}},de=R(Z,[["__scopeId","data-v-fc50c66d"]]);export{de as default};
